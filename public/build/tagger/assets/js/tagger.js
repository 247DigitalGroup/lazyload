var DataFrame,NoteList,PreviewFrame,Tagger,getArticleUrl,isBusy,taggerNode;$(function(){return FastClick.attach(document.body)});isBusy=false;getArticleUrl=""+taggerConfigs.apis.root+taggerConfigs.apis.tag;PreviewFrame=React.createClass({render:function(){return React.createElement("div",{className:"iframe-wrapper"},React.createElement("iframe",{className:"preview-box",src:this.props.data.url,width:"100%"}))}});NoteList=React.createClass({render:function(){var e;e=[];if(typeof this.props.data.notes!=="undefined"){e=this.props.data.notes.map(function(e){return React.createElement("li",null,e)})}return React.createElement("div",{className:"notes-wrapper"},React.createElement("ul",{className:"notes"},e),React.createElement("input",{type:"text",id:"note-input",placeholder:"enter your note here..."}))}});DataFrame=React.createClass({hotkeysHandler:function(e){if(e.target.id==="note-input"){return}switch(e.keyCode){case 96:this.toggleImageLowQuality();break;case 49:this.setCorrectHandler(this.props.data);break;case 50:this.setIncorrectHandler(this.props.data);break;case 51:this.setNotAnArticleHandler(this.props.data);break;case 52:this.setImageBlockedHandler(this.props.data);break}},getInitialState:function(){window.addEventListener("keypress",this.hotkeysHandler);return{}},componentDidMount:function(){var e;e=this.getDOMNode();return $(e).find("a.toggle").click(function(){return $(e).toggleClass("collapsed")})},toggleImageLowQuality:function(){var e;e=$(this.getDOMNode()).find("input#low-quality-image");return $(e).prop("checked",!$(e).prop("checked"))},isImageIsLowQuality:function(){return $(this.getDOMNode()).find("input#low-quality-image").prop("checked")},getNote:function(){var e;e=$(this.getDOMNode()).find("input#note-input").val();if(e===""){e=null}return e},getParams:function(e){var t,a;a={id:this.props.data._id,tag:e,low_quality:this.isImageIsLowQuality()};t=this.getNote();if(t!==null){a.note=t}console.log(a);return a},setCorrectHandler:function(){if(!isBusy){$(this.getDOMNode()).find("a#correct-button").addClass("s");return this.props.getDataHandler(this.getParams("y"))}},setIncorrectHandler:function(){if(!isBusy){$(this.getDOMNode()).find("a#incorrect-button").addClass("d");return this.props.getDataHandler(this.getParams("n"))}},setNotAnArticleHandler:function(){if(!isBusy){$(this.getDOMNode()).find("a#not-an-article-button").addClass("i");return this.props.getDataHandler(this.getParams("na"))}},setImageBlockedHandler:function(){if(!isBusy){$(this.getDOMNode()).find("a#image-blocked-button").addClass("w");return this.props.getDataHandler(this.getParams("b"))}},render:function(){return React.createElement("div",{id:"extracted-data",className:"tagger-box"},React.createElement("a",{className:"toggle bt d r"},"Ã—"),React.createElement("h1",{className:"title"},React.createElement("span",{className:"counter"},this.props.count),React.createElement("a",{href:this.props.data.url,target:"_blank"},this.props.data.title)),React.createElement("div",{className:"image"},React.createElement("input",{type:"checkbox",id:"low-quality-image"}),React.createElement("a",{href:this.props.data.image_url,target:"_blank"},React.createElement("img",{width:"100%",src:this.props.data.image_url}))),React.createElement(NoteList,{className:"notes",data:this.props.data}),React.createElement("div",{className:"rw sp-0 options"},React.createElement("div",{className:"cl sm-3"},React.createElement("a",{className:"bt alt ex",id:"correct-button",onClick:this.setCorrectHandler.bind(this,this.props.data)},"Correct")),React.createElement("div",{className:"cl sm-3"},React.createElement("a",{className:"bt alt ex",id:"incorrect-button",onClick:this.setIncorrectHandler.bind(this,this.props.data)},"Incorrect")),React.createElement("div",{className:"cl sm-3"},React.createElement("a",{className:"bt alt ex",id:"not-an-article-button",onClick:this.setNotAnArticleHandler.bind(this,this.props.data)},"NanA")),React.createElement("div",{className:"cl sm-3"},React.createElement("a",{className:"bt alt ex",id:"image-blocked-button",onClick:this.setImageBlockedHandler.bind(this,this.props.data)},"Blocked"))))}});Tagger=React.createClass({getInitialState:function(){return{count:0,data:{_id:"",url:"",title:"",image_url:"",notes:[]}}},getData:function(e){var t;if(!isBusy){if(typeof e==="undefined"){e={}}t=getArticleUrl;isBusy=true;return $.ajax({url:t,method:"post",data:e,xhrFields:{withCredentials:true},success:function(e,t,a){var r,n,s,i,c;if(this.isMounted){isBusy=false;this.setState({count:e.count,data:e.data});r=this.getDOMNode();$(r).find("input#low-quality-image").prop("checked",false).end().find("input#note-input").val("");setTimeout(function(){return $(r).find("div.options a").attr("class","bt alt ex")},200);try{i=this.getDOMNode();s=$(i).find("iframe");c=this;return $(s).load(function(){var e;e=$(s).contents().find('img[src="'+c.state.data.image_url+'"]');return $(e).css({padding:"1px",border:"10px solid rgb(237, 20, 91)"})})}catch(o){n=o;return console.log(n)}}}.bind(this),error:function(){return window.location.href="login.html"}})}},componentDidMount:function(){return this.getData()},render:function(){return React.createElement("div",{className:"tagger-wrapper"},React.createElement(DataFrame,{data:this.state.data,count:this.state.count,getDataHandler:this.getData}),React.createElement(PreviewFrame,{data:this.state.data}))}});taggerNode=document.getElementById("tagger");React.render(React.createElement(Tagger),taggerNode);